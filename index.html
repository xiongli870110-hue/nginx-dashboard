<!DOCTYPE html>
<html lang="zh-CN" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <title>运维门户</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <style>
    [data-theme="light"] body {
      background: linear-gradient(to bottom right, #f0f0f0, #d0d0d0);
      color: #222;
    }
    [data-theme="light"] .bg-white\/10 {
      background-color: rgba(0, 0, 0, 0.05);
    }
    [data-theme="light"] .hover\:bg-white\/20:hover {
      background-color: rgba(0, 0, 0, 0.1);
    }
    [data-theme="light"] input {
      color: #000;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-indigo-600 to-purple-700 min-h-screen text-white">
  <!-- 登录区 -->
  <div id="auth-wrapper" class="flex items-center justify-center h-screen">
    <div class="bg-white/10 backdrop-blur p-8 rounded-xl text-center max-w-md">
      <h2 class="text-xl font-bold mb-4"><i class="fas fa-lock mr-2"></i>请输入用户名和密码</h2>
      <input id="username-input" type="text" placeholder="用户名" class="w-full p-2 rounded text-black mb-2" />
      <input id="password-input" type="password" placeholder="密码" class="w-full p-2 rounded text-black mb-4" />
      <button onclick="checkLogin()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">
        登录
      </button>
      <p id="error-msg" class="text-red-300 mt-4 hidden">用户名或密码错误，请重试。</p>
    </div>
  </div>

  <!-- 页面导航与内容区 -->
  <div id="protected-content" style="display: none;" class="p-6">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-2xl font-bold">欢迎，<span id="user-name"></span></h2>
      <div class="space-x-2">
        <button onclick="toggleTheme()" class="bg-white/10 px-3 py-2 rounded hover:bg-white/20">
          <i class="fas fa-adjust text-sm mr-1"></i>切换主题
        </button>
        <button onclick="logout()" class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded">
          <i class="fas fa-sign-out-alt text-sm mr-1"></i>退出登录
        </button>
      </div>
    </div>
    <div id="nav-buttons" class="flex flex-wrap gap-4 justify-center mb-6"></div>
    <div id="iframe-wrapper" class="rounded-xl overflow-hidden shadow-lg">
      <iframe id="page-frame" src="" style="width:100%; height:80vh; border:none;"></iframe>
    </div>
  </div>

  <!-- 脚本逻辑 -->
  <script>
    const users = {
      admin: {
        password: "admin123",
        pages: ["nginx", "dashboard", "certbot", "portainer", "extra"]
      },
      li: {
        password: "nginxlover",
        pages: ["nginx", "dashboard"]
      },
      guest: {
        password: "readonly",
        pages: ["dashboard"]
      }
    };

    const allPages = {
      nginx: { name: "Nginx配置", file: "nginx.html", icon: "fa-server" },
      dashboard: { name: "仪表盘", file: "dashboard.html", icon: "fa-tachometer-alt" },
      certbot: { name: "证书管理", file: "certbot.html", icon: "fa-certificate" },
      portainer: { name: "容器控制", file: "portainer.html", icon: "fa-boxes" },
      extra: { name: "扩展页面", file: "extra.html", icon: "fa-puzzle-piece" }
    };

    function checkLogin() {
      const username = document.getElementById("username-input").value.trim();
      const password = document.getElementById("password-input").value.trim();
      const error = document.getElementById("error-msg");
      if (users[username] && users[username].password === password) {
        localStorage.setItem("authUser", username);
        document.getElementById("auth-wrapper").style.display = "none";
        document.getElementById("protected-content").style.display = "block";
        document.getElementById("user-name").textContent = username;
        renderButtons(username);
        loadPage(users[username].pages[0]);
      } else {
        error.style.display = "block";
      }
    }

    function renderButtons(username) {
      const container = document.getElementById("nav-buttons");
      container.innerHTML = "";
      users[username].pages.forEach(key => {
        const page = allPages[key];
        const btn = document.createElement("button");
        btn.className = "bg-white/10 px-4 py-2 rounded hover:bg-white/20 flex items-center";
        btn.innerHTML = `<i class="fas ${page.icon} text-sm mr-2"></i>${page.name}`;
        btn.onclick = () => loadPage(page.file);
        container.appendChild(btn);
      });
    }

    function loadPage(file) {
      document.getElementById("page-frame").src = file;
    }

    function logout() {
      localStorage.removeItem("authUser");
      location.reload();
    }

    function toggleTheme() {
      const html = document.documentElement;
      const current = html.getAttribute("data-theme");
      const next = current === "dark" ? "light" : "dark";
      html.setAttribute("data-theme", next);
      localStorage.setItem("theme", next);
    }

    window.onload = function () {
      const theme = localStorage.getItem("theme") || "dark";
      document.documentElement.setAttribute("data-theme", theme);
      const username = localStorage.getItem("authUser");
      if (username && users[username]) {
        document.getElementById("auth-wrapper").style.display = "none";
        document.getElementById("protected-content").style.display = "block";
        document.getElementById("user-name").textContent = username;
        renderButtons(username);
        loadPage(users[username].pages[0]);
      }
    };
  </script>
</body>
</html>
